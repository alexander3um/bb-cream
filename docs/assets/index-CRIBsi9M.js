(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&t(c)}).observe(document,{childList:!0,subtree:!0});function o(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(e){if(e.ep)return;e.ep=!0;const s=o(e);fetch(e.href,s)}})();const v=new RegExp("((?<=\\[\\/url]\\s*\\[\\/d]\\n|\\[\\/url]\\s*\\[\\/d]\\s*\\[\\/r]\\s*\\[\\/c])(?!\\n*\\[d|\\[atta)|(?<=\\.jar])(?=\\n*[1-9]+))","gim"),f=/\d+(\.\d+)+/gim,k=r=>{const n=r.split(v).filter(t=>!!t).map(t=>t.trim()).filter(t=>f.test(t)),o={};for(const t of n){const e=t.match(f);if(!e)throw new Error("Не получилось распарсить версии");o[e[0]]=t}return o},p=(r,n)=>{const t=[...n.matchAll(/(\[attachment=(?<attachment>\d+:.*?)]|\[url=(?<link>.*?)](?<name>.*?)\[\/url])/gim)][0];if(!t||!t.groups)throw new Error(`${r}: не понимаю что тут надо скочать`);return t.groups.attachment?{linkType:"attachment",link:t.groups.attachment}:{linkType:"url",link:t.groups.link}},b=(r,n)=>{const o=p(r,n);return{version:r,loader:"forge",dependencies:[],...o}},l={forge:"/mody-minecraft/797-minecraft-forge.html",neoforge:"/mody-minecraft/77411-neoforge.html",fabric:"/mody-minecraft/54974-fabric-mod-loader-mod-yadro-dlya-114.html"},h=(r,n)=>{var e,s;const o=n.matchAll(/\[url=(?<link>.*?\.html)](?<name>.*?)\[\/url]/gim),t=[];for(const c of o){const i=(e=c.groups)==null?void 0:e.name,a=(s=c.groups)==null?void 0:s.link;if(!i||!a)throw new Error(`${r}: не получилось распарсить зависимости`);Object.keys(l).includes(i.toLowerCase())||t.push({name:i,link:a})}return t},g=r=>{for(const n of Object.keys(l)){const o=l[n];if(r.includes(o))return n}return"forge"},w=(r,n)=>{const[o,t]=n.split(/(?=\[d].*?\[\/d])/gim);if(!t)throw new Error(`${r}: не понимаю что именно тут скочать`);const e=p(r,o),s=h(r,t),c=g(n);return{version:r,loader:c,dependencies:s,...e}},L=(r,n)=>{const o=[],t=n.matchAll(/(\[attachment=(?<attachment>.*?)]|\[url=(?<link>.*?)].*?\[\/url])\n*(\[d](?<dependencies>.*?)\[\/d])/gim);for(const e of t){const s=(()=>{var c,i,a,m;if((c=e.groups)!=null&&c.attachment)return{link:(i=e.groups)==null?void 0:i.attachment,linkType:"attachment"};if((a=e.groups)!=null&&a.link)return{link:(m=e.groups)==null?void 0:m.link,linkType:"url"}})();if(!s)throw new Error(`${r}: не понимаю что тут можно скочать`);o.push({version:r,loader:g(e[0]),dependencies:h(r,e[0]),...s})}return o},$=r=>{const n=k(r.trim().startsWith("[download]")?r.slice(10,-11):r),o=[];for(const t of Object.keys(n)){const e=n[t];if(/\[c]\[l]\d+(\.\d+)+/gim.test(e)){o.push(...L(t,e));continue}if(/(\[d]|\[\/d])/gim.test(e)){o.push(w(t,e));continue}o.push(b(t,e))}return o},x=r=>[...r].sort((n,o)=>{const t=n.version.split("."),e=o.version.split(".");for(let s=0;s<3;s++){const c=Number(t[s]),i=Number(e[s]);if(c>i)return 1;if(i>c)return-1;if(!isNaN(c)&&isNaN(i))return 1;if(isNaN(c)&&!isNaN(i))return-1}return 0}).reverse(),N=r=>{const n=x(r),o={};for(const e of n){const s=e.linkType==="attachment"?`[attachment=${e.link}]`:`[url=${e.link}]${e.link}[/url]`,c=e.dependencies.map(a=>`[url=${a.link}]${a.name}[/url]`).join(" и "),i=e.dependencies.length>0?`[dep]требуется установить ${c}[/dep]`:"";o[e.version]=(o[e.version]??"")+`[${e.loader}]${s}${i}[/${e.loader}]`}const t=[];for(const e of Object.keys(o))t.push(`[vers][v]${e}[/v][files]${o[e]}[/files][/vers]`);return t.join(`

`)},E=r=>N($(r));document.querySelector("#app").innerHTML=`
  <div class="box">
    <div class="box-from">
      <textarea></textarea>
    </div>
    <div class="box-to">
      <textarea readonly></textarea>
    </div>
  </div> 
`;const d=document.querySelector(".box-from textarea"),u=document.querySelector(".box-to textarea");if(!d||!u)throw new Error("Браузер-то клоунский");const y=r=>{const n=r.target;if(n){n.classList.remove("error");try{u.value=E(n.value)}catch(o){n.classList.add("error"),console.error(o)}}};d.addEventListener("change",y);d.addEventListener("keyup",y);u.addEventListener("click",async r=>{const n=r.target;n&&await navigator.clipboard.writeText(n.value)});
